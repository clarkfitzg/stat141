---
title: "hw6 - Simpson's paradox"
author: "TODO"
format:
  html:
    self-contained: true
editor: visual
---

A study of conducted in Whickham, England recorded participants' age, smoking status at baseline, and then 20 years later recorded their health outcome.
In this lab we analyse the relationships between these variables, first two at a time, and then controlling for the third.

# Learning goals

-   Visualising relationships between variables
-   Discovering Simpson's paradox via visualisations


## Packages

We'll use the **tidyverse** package for much of the data wrangling and visualisation and the data comes from the **mosaicData** package.

You can load them by running the following in your Console:

```{r eval = TRUE, message = FALSE}
library(tidyverse) 
#library(mosaicData) 
Whickham <- read_csv("https://github.com/clarkfitzg/stat141/raw/refs/heads/main/data/Whickham.csv")
```

## Data

The dataset we'll use is called Whickham from the **mosaicData** package.
You can find out more about the dataset at https://rdrr.io/cran/mosaicData/man/Whickham.html 

# Exercises

1.  What type of study do you think these data come from: observational or experiment?
    Why?

2.  How many observations are in this dataset?
    What does each observation represent?

3.  How many variables are in this dataset?
    What type of variable is each?
    Display each variable using an appropriate visualization.

4.  What would you expect the relationship between smoking status and health outcome to be?

5.  Create a visualization depicting the relationship between smoking status and health outcome. Briefly describe the relationship, and evaluate whether this meets your expectations. Additionally, calculate the relevant conditional probabilities to help your narrative. Here is some code to get you started:

```{r}
Whickham %>%
  count(smoker, outcome)
```

6.  Create a new variable called `age_cat` using the following scheme:

-   `age <= 44 ~ "18-44"`
-   `age > 44 & age <= 64 ~ "45-64"`
-   `age > 64 ~ "65+"`

7.  Re-create the visualization depicting the relationship between smoking status and health outcome, faceted by `age_cat`. What changed? What might explain this change? Extend the contingency table from earlier by breaking it down by age category and use it to help your narrative.

```{r}
#Whickham %>%
#  count(smoker, age_cat, outcome)
```

8. Come up with your own question and visualization regarding the `Whickham` data.